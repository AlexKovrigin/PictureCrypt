\hypertarget{modelpc_8cpp_source}{}\section{modelpc.\+cpp}
\label{modelpc_8cpp_source}\index{C\+:/\+Users/salex/\+Documents/\+Git\+Hub/\+Picture\+Crypt/modelpc.\+cpp@{C\+:/\+Users/salex/\+Documents/\+Git\+Hub/\+Picture\+Crypt/modelpc.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\mbox{\hyperlink{modelpc_8h}{modelpc.h}}"}
00002 \textcolor{preprocessor}{#include <QDebug>}
\Hypertarget{modelpc_8cpp_source_l00008}\mbox{\hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{00008}} \mbox{\hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{ModelPC::ModelPC}}()
00009 \{
00010     \textcolor{comment}{// Version control}
00011     \mbox{\hyperlink{class_model_p_c_a5f426725ccf7eefd3c77ea8c720264c9}{versionString}} = \textcolor{stringliteral}{"1.3.0"};
00012 
00013     \textcolor{keyword}{auto} ver = \mbox{\hyperlink{class_model_p_c_a5f426725ccf7eefd3c77ea8c720264c9}{versionString}}.split(\textcolor{stringliteral}{"."});
00014     \mbox{\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}} = ver[0].toInt() * pow(2, 16) + ver[1].toInt() * pow(2, 8) + ver[2].toInt();
00015 
00016     ver\_byte = bytes(ver[0].toInt()) +
00017             bytes(ver[1].toInt()) +
00018             bytes(ver[2].toInt());
00019     \textcolor{comment}{// Random seed}
00020     qsrand(randSeed());
00021 \}
\Hypertarget{modelpc_8cpp_source_l00034}\mbox{\hyperlink{class_model_p_c_a3cae34fd5bcb06e8c1f8cfe7961bd270}{00034}} QImage * \mbox{\hyperlink{class_model_p_c_a3cae34fd5bcb06e8c1f8cfe7961bd270}{ModelPC::start}}(QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, QImage * \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, \textcolor{keywordtype}{int} 
      \mbox{\hyperlink{namespacetests-setup_a04126d10edec6b3171e1b55a00309b23}{mode}}, QString \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}, \textcolor{keywordtype}{int} \_bitsUsed, QString *\_error)
00035 \{
00036     \textcolor{comment}{// Error management}
00037     *\_error = \textcolor{stringliteral}{"ok"};
00038     \mbox{\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error}} = \_error;
00039 
00040     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.isEmpty()) \{
00041         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"nodata"});
00042         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00043     \}
00044     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}} == \textcolor{keyword}{nullptr} || \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->isNull()) \{
00045         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"nullimage"});
00046         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00047     \}
00048     \textcolor{keywordflow}{if}(\_bitsUsed < 1 || \_bitsUsed > 8) \{
00049         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"bitsWrong"});
00050         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00051     \}
00052     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}.isEmpty()) \{
00053         qsrand(randSeed());
00054         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 32; i++)
00055             \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}.append(48 + qrand() % 75);
00056     \}
00057     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}.size() > 255) \{
00058         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"bigkey"});
00059         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00060     \}
00061     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} usedBytes = \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.size() + 14 + \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}.size();
00062     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} size = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->width() * \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->height();
00063     \textcolor{keywordflow}{if}(usedBytes * 100 / (size * 3) * 8 / \_bitsUsed > 70) \{
00064         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"muchdata"});
00065         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00066     \}
00067 
00068     \mbox{\hyperlink{class_model_p_c_ad74974ac236182c1d6d2cf0729fac3dd}{curMode}} = \mbox{\hyperlink{namespacetests-setup_a04126d10edec6b3171e1b55a00309b23}{mode}};
00069     \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} = \_bitsUsed;
00070 
00071     QByteArray key\_data = \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}.toUtf8();
00072     QByteArray zipped\_data = \mbox{\hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{zip}}(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, key\_data);
00073     QByteArray encr\_data = bytes(key\_data.size()) + key\_data + zipped\_data;
00074 
00075     \textcolor{keywordflow}{if}(*\mbox{\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error}} == \textcolor{stringliteral}{"ok"})
00076         \textcolor{keywordflow}{return} \mbox{\hyperlink{class_model_p_c_a8ef76567bc0c0307b4e2547c46536e51}{encrypt}}(encr\_data, \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, \mbox{\hyperlink{class_model_p_c_ad74974ac236182c1d6d2cf0729fac3dd}{curMode}}, \mbox{\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error}});
00077     \textcolor{keywordflow}{else}
00078         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00079 \}
00080 
\Hypertarget{modelpc_8cpp_source_l00090}\mbox{\hyperlink{class_model_p_c_a8ef76567bc0c0307b4e2547c46536e51}{00090}} QImage * \mbox{\hyperlink{class_model_p_c_a8ef76567bc0c0307b4e2547c46536e51}{ModelPC::encrypt}}(QByteArray encr\_data, QImage * \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, \textcolor{keywordtype}{int} 
      \mbox{\hyperlink{namespacetests-setup_a04126d10edec6b3171e1b55a00309b23}{mode}}, QString *\_error)
00091 \{
00092     \textcolor{comment}{// Error management}
00093     *\_error = \textcolor{stringliteral}{"ok"};
00094     \mbox{\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error}} = \_error;
00095 
00096     \textcolor{comment}{// TODO Remove debug mode = 0}
00097     \mbox{\hyperlink{namespacetests-setup_a04126d10edec6b3171e1b55a00309b23}{mode}} = 0;
00098 
00099     \textcolor{keywordflow}{if}(encr\_data.isEmpty()) \{
00100         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"nodata"});
00101         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00102     \}
00103     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}} == \textcolor{keyword}{nullptr} || \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->isNull()) \{
00104         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"nullimage"});
00105         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00106     \}
00107 
00108     encr\_data = ver\_byte + encr\_data;
00109     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} countBytes = encr\_data.size();
00110     \mbox{\hyperlink{class_model_p_c_ad74974ac236182c1d6d2cf0729fac3dd}{curMode}} = \mbox{\hyperlink{namespacetests-setup_a04126d10edec6b3171e1b55a00309b23}{mode}};
00111     \textcolor{keywordflow}{switch}(\mbox{\hyperlink{class_model_p_c_ad74974ac236182c1d6d2cf0729fac3dd}{curMode}})
00112     \{
00113     \textcolor{keywordflow}{case} 0:
00114         \mbox{\hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{circuit}}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, &encr\_data, countBytes);
00115         \textcolor{keywordflow}{break};
00116     \textcolor{keywordflow}{case} 1:
00117         \mbox{\hyperlink{class_model_p_c_a8bee0255c09449868c7e6097afaaf0cd}{jphs}}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, &encr\_data);
00118         \textcolor{keywordflow}{break};
00119     \textcolor{keywordflow}{default}:
00120         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"wrongmode"});
00121         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00122     \}
00123 
00124 
00125     \textcolor{comment}{// Saving}
00126     \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}}) \{
00127         emit \mbox{\hyperlink{class_model_p_c_a5af79bd5fd50d7be0646778bc99413b9}{saveImage}}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}});
00128         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}};
00129     \}
00130     \textcolor{keywordflow}{else}
00131         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00132 \}
\Hypertarget{modelpc_8cpp_source_l00140}\mbox{\hyperlink{class_model_p_c_af1f0b21565bf39808c4cdd448fad0ea8}{00140}} QByteArray \mbox{\hyperlink{class_model_p_c_af1f0b21565bf39808c4cdd448fad0ea8}{ModelPC::decrypt}}(QImage * \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, QString *\_error)
00141 \{
00142     \textcolor{comment}{// Error management}
00143     *\_error = \textcolor{stringliteral}{"ok"};
00144     \mbox{\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error}} = \_error;
00145     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}} == \textcolor{keyword}{nullptr} || \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->isNull()) \{
00146         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"nullimage"});
00147         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00148     \}
00149     \textcolor{comment}{// Image opening}
00150     \textcolor{keywordtype}{int} w = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->width();
00151     \textcolor{keywordtype}{int} h = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->height();
00152 
00153     \textcolor{comment}{// Getting corner pixels}
00154     QColor colUL = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(0, 0).toRgb();
00155     QColor colUR = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(w - 1, 0).toRgb();
00156     QColor colDR = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(w - 1, h - 1).toRgb();
00157 
00158     \textcolor{comment}{// Getting verification code}
00159     \textcolor{keywordtype}{int} verifCode = (((colUR.green() % 2) << 5) + colUR.blue() % 32) << 2;
00160     verifCode += colDR.blue() % 4;
00161     \textcolor{keywordflow}{if}(verifCode != 166)\{
00162         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"veriffail"});
00163         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00164     \}
00165     \textcolor{comment}{// Getting number of bytes}
00166     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} countBytes = (colUL.blue() % 32 + ((colUL.green() % 32) << 5) + ((colUL.red() % 32) << 10
      )) << 9;
00167     countBytes += ((colUR.red() % 32) << 4) + (colUR.green() >> 1) % 16;
00168 
00169     \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} = (colDR.blue() >> 2) % 8 + 1;
00170     \mbox{\hyperlink{class_model_p_c_ad74974ac236182c1d6d2cf0729fac3dd}{curMode}} = colDR.green() % 32;
00171 
00172     \textcolor{comment}{// Start of the circuit}
00173     QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}};
00174     \mbox{\hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{circuit}}(\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, &\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, countBytes);
00175 
00176     \textcolor{comment}{// Check if circuit was successful}
00177     \textcolor{keywordflow}{if}(!\mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}})
00178         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00179     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.isEmpty())
00180     \{
00181         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"noreaddata"});
00182         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00183 
00184     \}
00185     \textcolor{comment}{// Version check}
00186     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} \_ver = mod(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.at(0) * pow(2, 16));
00187     \_ver += mod(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.at(1) * pow(2, 8));
00188     \_ver += mod(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.at(2));
00189     \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.remove(0, 3);
00190     \textcolor{keywordflow}{if}(\_ver > \mbox{\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}}) \{
00191         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"Picture's app version is newer than yours. Image version is "}
00192               + generateVersionString(\_ver) + \textcolor{stringliteral}{", yours is "}
00193               + generateVersionString(\mbox{\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}}) + \textcolor{stringliteral}{"."});
00194         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00195     \}
00196     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\_ver < \mbox{\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}}) \{
00197         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"Picture's app version is older than yours. Image version is "}
00198               + generateVersionString(\_ver) + \textcolor{stringliteral}{", yours is "}
00199               + generateVersionString(\mbox{\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}}) + \textcolor{stringliteral}{"."});
00200         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00201     \}
00202 
00203     \textcolor{comment}{// Obtain the key}
00204     \textcolor{keywordtype}{int} key\_size = mod(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.at(0));
00205     QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}} = \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.mid(1, key\_size);
00206     \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}.remove(0, key\_size + 1);
00207 
00208     \textcolor{comment}{// Unzip}
00209     QByteArray unzipped\_data = \mbox{\hyperlink{class_model_p_c_a6da88f166785a49f73b22c169f956fd0}{unzip}}(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}});
00210     emit \mbox{\hyperlink{class_model_p_c_a67c4fd6db2cd4a3bb23a2fc48f7cceff}{saveData}}(unzipped\_data);
00211     \textcolor{keywordflow}{return} unzipped\_data;
00212 \}
\Hypertarget{modelpc_8cpp_source_l00217}\mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{00217}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{ModelPC::fail}}(QString message)
00218 \{
00219     *\mbox{\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error}} = message;
00220     \mbox{\hyperlink{class_model_p_c_a9079a101d83672aa48fd2dbac797de40}{alert}}(message, \textcolor{keyword}{true});
00221     \mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}} = \textcolor{keyword}{false};
00222     emit \mbox{\hyperlink{class_model_p_c_a25a4496e129e87ac96f12257a123b84f}{setProgress}}(101);
00223 \}
\Hypertarget{modelpc_8cpp_source_l00229}\mbox{\hyperlink{class_model_p_c_a8bee0255c09449868c7e6097afaaf0cd}{00229}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_model_p_c_a8bee0255c09449868c7e6097afaaf0cd}{ModelPC::jphs}}(QImage *\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, QByteArray *\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}})
00230 \{
00231     \textcolor{comment}{// Under Development}
00232     \textcolor{keywordflow}{return};
00233 
00234     \textcolor{comment}{// Dead code}
00235 
00236     \mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}} = \textcolor{keyword}{true};
00237     \textcolor{keywordtype}{bool} isEncrypt = !\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}->isEmpty();
00238     QString targetEXE = \mbox{\hyperlink{class_model_p_c_abd038306f14f22fb885a1697c96d6335}{defaultJPHSDir}} + (isEncrypt ? \textcolor{stringliteral}{"/jphide.exe"} : \textcolor{stringliteral}{"/jpseek.exe"});
00239     \textcolor{keywordflow}{if}(!fileExists(targetEXE))
00240     \{
00241         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"nojphs"});
00242         \textcolor{keywordflow}{return};
00243     \}
00244 
00245     QString randomFileName = \mbox{\hyperlink{class_model_p_c_abd038306f14f22fb885a1697c96d6335}{defaultJPHSDir}} + \textcolor{stringliteral}{"/"};
00246     qsrand(randSeed());
00247     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 10; i++)
00248         randomFileName.append(97 + qrand() % 25);
00249     \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->save(randomFileName + \textcolor{stringliteral}{".jpg"});
00250     \textcolor{keywordflow}{if}(isEncrypt) \{
00251         QFile file(randomFileName + \textcolor{stringliteral}{".pc"});
00252         \textcolor{keywordflow}{if}(!file.open(QFile::WriteOnly)) \{
00253             \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"savefilefail"});
00254             \textcolor{keywordflow}{return};
00255         \}
00256         file.write(*\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}});
00257         file.close();
00258 
00259         QStringList args;
00260         args << (randomFileName + \textcolor{stringliteral}{".jpg"}) << (randomFileName + \textcolor{stringliteral}{"\_out.jpg"}) << (randomFileName + \textcolor{stringliteral}{".pc"});
00261         QProcess prog(\textcolor{keyword}{this});
00262         prog.start(targetEXE, args);
00263         prog.waitForStarted();
00264         prog.write(\textcolor{stringliteral}{"test\(\backslash\)n"});
00265         prog.waitForBytesWritten();
00266         prog.write(\textcolor{stringliteral}{"test\(\backslash\)n"});
00267         prog.waitForBytesWritten();
00268         prog.waitForReadyRead();
00269         QByteArray bytes = prog.readAll();
00270         prog.waitForFinished();
00271         \textcolor{comment}{//QByteArray readData = prog.readAll();}
00272         prog.close();
00273         \textcolor{comment}{// Cleaning - Deleting temp files}
00274 
00275     \}
00276     \textcolor{keywordflow}{else} \{
00277 
00278     \}
00279 
00280 \}
00281 
\Hypertarget{modelpc_8cpp_source_l00290}\mbox{\hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{00290}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{ModelPC::circuit}}(QImage *\mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}, QByteArray *\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} countBytes)
00291 \{
00292 
00293     \textcolor{comment}{// Some flags and creation of the ProgressDialog}
00294     \mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}} = \textcolor{keyword}{true};
00295     emit \mbox{\hyperlink{class_model_p_c_a25a4496e129e87ac96f12257a123b84f}{setProgress}}(-1);
00296     \textcolor{keywordtype}{bool} isEncrypt = !\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}->isEmpty();
00297 
00298     \textcolor{comment}{// Image setup}
00299     \textcolor{keywordtype}{int} w = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->width();
00300     \textcolor{keywordtype}{int} h = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->height();
00301 
00302     \textcolor{comment}{// Visited pixels array}
00303     QVector <QPoint> were;
00304     were.push\_back(QPoint(0, 0));
00305     were.push\_back(QPoint(0, h - 1));
00306     were.push\_back(QPoint(w - 1, 0));
00307     were.push\_back(QPoint(w - 1, h - 1));
00308 
00309     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} offset = 0;
00310 
00311     \textcolor{comment}{// Pre-start Cleaning}
00312     circuitData = \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}};
00313     circuitImage = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}};
00314     circuitCountBytes = countBytes;
00315     cur = 0;
00316     bitsBuffer.clear();
00317 
00318     \textcolor{comment}{// Writing Top-Left to Bottom-Left}
00319     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 1; i < h - 1 && mustGoOn(isEncrypt); i++) \{
00320         QPoint pos(0, i);
00321         \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}}(pos, &were, isEncrypt);
00322     \}
00323     \textcolor{comment}{// Writing Bottom-Right to Top-Right}
00324     \textcolor{keywordflow}{if}(mustGoOn(isEncrypt))
00325     \{
00326         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = h - 2; i >= 1 && mustGoOn(isEncrypt); i--)\{
00327             QPoint pos(w - 1, i);
00328             \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}}(pos, &were, isEncrypt);
00329         \}
00330     \}
00331     \textcolor{comment}{// Main cycle}
00332     \textcolor{comment}{// Strong is considered as actual corner pixel and weak as pixel near it like (1, 0) or (0, 1)}
00333     \textcolor{keywordflow}{while}(mustGoOn(isEncrypt))
00334     \{
00335         \textcolor{comment}{// Strong Top-Right to Strong Bottom-Right}
00336         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = offset; i < h - offset && mustGoOn(isEncrypt); i++)\{
00337             QPoint pos(w - offset - 2, i);
00338             \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}}(pos, &were, isEncrypt);
00339         \}
00340         \textcolor{comment}{// Strong Top-Left to Weak Top-Right}
00341         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = offset + 1; i < w - offset - 2 && mustGoOn(isEncrypt); i++)\{
00342             QPoint pos(i, offset);
00343             \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}}(pos, &were, isEncrypt);
00344         \}
00345         \textcolor{comment}{// Weak Bottom-Right to Weak Bottom-Left}
00346         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = w - 3 - offset; i >= offset + 2 && mustGoOn(isEncrypt); i--)\{
00347             QPoint pos(i, h - offset - 1);
00348             \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}}(pos, &were, isEncrypt);
00349         \}
00350         \textcolor{comment}{// Weak Top-Left to Strong Bottom-Left}
00351         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = offset + 1; i < h - offset && mustGoOn(isEncrypt); i++)\{
00352             QPoint pos(offset + 1, i);
00353             \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}}(pos, &were, isEncrypt);
00354         \}
00355         offset++;
00356     \}
00357     \textcolor{comment}{// Extra writing}
00358     \textcolor{keywordflow}{if}(!\mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}})
00359         \textcolor{keywordflow}{return};
00360     \textcolor{keywordflow}{if}(isEncrypt)
00361     \{
00362         \textcolor{comment}{// Getting past colors}
00363         QColor colUL = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(0, 0).toRgb();
00364         QColor colUR = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(w - 1, 0).toRgb();
00365         QColor colDL = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(0, h - 1).toRgb();
00366         QColor colDR = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(w - 1, h - 1).toRgb();
00367         \textcolor{keywordtype}{int} red = 0;
00368         \textcolor{keywordtype}{int} green = 0;
00369         \textcolor{keywordtype}{int} blue = 0;
00370 
00371         \textcolor{comment}{// Writing Upper Left}
00372         red = (colUL.red() & 224) + (countBytes >> 19);
00373         green = (colUL.green() & 224) + (countBytes >> 14) % 32;
00374         blue = (colUL.blue() & 224) + (countBytes >> 9) % 32;
00375         \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->setPixelColor(0, 0, QColor(red, green, blue));
00376 
00377         \textcolor{comment}{// Writing Upper Right}
00378         red = (colUR.red() & 224) + (countBytes >> 4) % 32;
00379         green = (colUR.green() & 224) + ((countBytes % 16) << 1) + 1;
00380         blue = (colUR.blue() & 224) + 9;
00381         \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->setPixelColor(w - 1, 0, QColor(red, green, blue));
00382 
00383         \textcolor{comment}{// Getting extra bytes if left}
00384         \textcolor{keywordflow}{while}(cur < countBytes)
00385             push(mod(circuitData->at(cur++)), 8);
00386         \textcolor{keywordflow}{if}(bitsBuffer.size() > 20) \{
00387             \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"bitsBufferFail"});
00388             \textcolor{keywordflow}{return};
00389         \}
00390         \textcolor{comment}{// Getting extra data as long.}
00391         \textcolor{keywordtype}{long} extraData = pop(-2);
00392 
00393         \textcolor{comment}{// Writing Down Left}
00394         red = (colDL.red() & 224) + (extraData >> 15);
00395         green = (colDL.green() & 224) + (extraData >> 10) % 32;
00396         blue = (colDL.blue() & 224) + (extraData >> 5) % 32;
00397         \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->setPixelColor(0, h - 1, QColor(red, green, blue));
00398 
00399         \textcolor{comment}{// Writing Down Right}
00400         red = (colDR.red() & 224) + extraData % 32;
00401         green = (colDR.green() & 224);
00402         blue = (colDR.blue() & 224) + ((\mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} - 1) << 2) + 2;
00403         \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->setPixelColor(w - 1, h - 1, QColor(red, green, blue));
00404     \}
00405     \textcolor{keywordflow}{else}
00406     \{
00407         \textcolor{comment}{// Read the past pixels}
00408         QColor colDL = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(0, h - 1).toRgb();
00409         QColor colDR = \mbox{\hyperlink{namespacetests-setup_ad55b685280f549e15688a94cbb89f512}{image}}->pixelColor(w - 1, h - 1).toRgb();
00410 
00411         \textcolor{comment}{// Read extra data}
00412         \textcolor{keywordtype}{long} extraData = ((colDL.red() % 32) << 15) + ((colDL.green() % 32) << 10);
00413         extraData += ((colDL.blue() % 32) << 5) + colDR.red() % 32;
00414 
00415         \textcolor{comment}{// Add extra data to the bitsBuffer}
00416         push(extraData, (countBytes - cur) * 8 - bitsBuffer.size());
00417 
00418         \textcolor{comment}{// Move bits from bitsBuffer to the QByteArray}
00419         \textcolor{keywordflow}{while}(!bitsBuffer.isEmpty())
00420             \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}->append(pop(8));
00421     \}
00422     emit \mbox{\hyperlink{class_model_p_c_a25a4496e129e87ac96f12257a123b84f}{setProgress}}(101);
00423 \}
00424 
\Hypertarget{modelpc_8cpp_source_l00432}\mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{00432}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{ModelPC::processPixel}}(QPoint pos, QVector<QPoint> *were, \textcolor{keywordtype}{bool} isEncrypt)
00433 \{
00434     \textcolor{keywordflow}{if}(!\mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}})
00435         \textcolor{keywordflow}{return};
00436     \textcolor{comment}{// Check if point was already visited}
00437     \textcolor{keywordflow}{if}(were->contains(pos))\{
00438         \mbox{\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}}(\textcolor{stringliteral}{"Point ("} + QString::number(pos.x()) + \textcolor{stringliteral}{","} + QString::number(pos.y()) + \textcolor{stringliteral}{") was visited
       twice! Error code 2"});
00439         \textcolor{keywordflow}{return};
00440     \}
00441     \textcolor{keywordflow}{else}
00442         were->push\_back(pos);
00443     \textcolor{keywordflow}{if}(isEncrypt)
00444     \{
00445         \textcolor{comment}{// Make sure that there are enough bits in bitsBuffer to write}
00446         \textcolor{keywordflow}{while}(bitsBuffer.size() < 3 * \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}})
00447             push(mod(circuitData->at(cur++)), 8);
00448         \textcolor{comment}{// Read past contains}
00449         QColor pixelColor = circuitImage->pixelColor(pos);
00450         \textcolor{keywordtype}{int} red = pixelColor.red();
00451         \textcolor{keywordtype}{int} green = pixelColor.green();
00452         \textcolor{keywordtype}{int} blue = pixelColor.blue();
00453 
00454         \textcolor{comment}{// Write new data in last bitsUsed pixels}
00455         red += pop() - red % (int) pow(2, \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}});
00456         green += pop() - green % (int) pow(2, \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}});
00457         blue += pop() - blue % (int) pow(2, \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}});
00458 
00459         circuitImage->setPixelColor(pos, QColor(red, green, blue));
00460     \}
00461     \textcolor{keywordflow}{else}
00462     \{
00463         QColor read\_color = circuitImage->pixelColor(pos).toRgb();
00464         \textcolor{comment}{// Reading the pixel}
00465         \textcolor{keywordtype}{int} red = read\_color.red();
00466         \textcolor{keywordtype}{int} green = read\_color.green();
00467         \textcolor{keywordtype}{int} blue = read\_color.blue();
00468 
00469         \textcolor{comment}{// Reading the last bitsUsed pixels}
00470         red %= (int) pow(2, \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}});
00471         green %= (int) pow(2, \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}});
00472         blue %= (int) pow(2, \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}});
00473 
00474         \textcolor{comment}{// Getting the data in the bitsBuffer.}
00475         push(red);
00476         push(green);
00477         push(blue);
00478 
00479         \textcolor{comment}{// Getting data to QByteArray}
00480         \textcolor{keywordflow}{while}(bitsBuffer.size() >= 8) \{
00481             circuitData->append(pop(8));
00482             cur++;
00483         \}
00484     \}
00485     emit \mbox{\hyperlink{class_model_p_c_a25a4496e129e87ac96f12257a123b84f}{setProgress}}(100 * cur / circuitCountBytes);
00486 \}
00487 
00488 \textcolor{keywordtype}{long} ModelPC::pop(\textcolor{keywordtype}{int} bits)
00489 \{
00490     \textcolor{comment}{// Hard to say}
00491     \textcolor{keywordtype}{long} res = 0;
00492     \textcolor{keywordtype}{int} poppedBits = bits == -1 ? \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} : bits;
00493     \textcolor{keywordflow}{if}(bits == -2)
00494         poppedBits = bitsBuffer.size();
00495     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < poppedBits; i++)
00496         res += bitsBuffer[i] * pow(2, poppedBits - i - 1);
00497     bitsBuffer.remove(0, poppedBits);
00498     \textcolor{keywordflow}{return} res;
00499 \}
00500 
00501 \textcolor{keywordtype}{void} ModelPC::push(\textcolor{keywordtype}{int} \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, \textcolor{keywordtype}{int} bits)
00502 \{
00503     \textcolor{comment}{// That's easier, but also hard}
00504     \textcolor{keywordtype}{int} buf\_size = bitsBuffer.size();
00505     \textcolor{keywordtype}{int} extraSize = bits == -1 ? \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} : bits;
00506     bitsBuffer.resize(buf\_size + extraSize);
00507     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = bitsBuffer.size() - 1; i >= buf\_size; i--, \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}} >>= 1)
00508         bitsBuffer[i] = \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}} % 2;
00509 \}
00510 
00511 \textcolor{keywordtype}{bool} ModelPC::mustGoOn(\textcolor{keywordtype}{bool} isEncrypt)
00512 \{
00513     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}} && (isEncrypt ? (circuitCountBytes - cur) * 8 + bitsBuffer.size() >= 
      \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} * 3 :
00514                                    circuitData->size() * 8 + bitsBuffer.size() <
00515                                    circuitCountBytes * 8 - (circuitCountBytes * 8)% (
      \mbox{\hyperlink{class_model_p_c_a655deb6a8afa94c7f4aadb3056989038}{bitsUsed}} * 3));
00516 \}
\Hypertarget{modelpc_8cpp_source_l00525}\mbox{\hyperlink{class_model_p_c_a6da88f166785a49f73b22c169f956fd0}{00525}} QByteArray \mbox{\hyperlink{class_model_p_c_a6da88f166785a49f73b22c169f956fd0}{ModelPC::unzip}}(QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}})
00526 \{
00527     \textcolor{comment}{// Decryption}
00528     QByteArray hashKey = QCryptographicHash::hash(\mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}, QCryptographicHash::Sha256);
00529     \mbox{\hyperlink{class_q_a_e_s_encryption}{QAESEncryption}} encryption(\mbox{\hyperlink{class_q_a_e_s_encryption_abe48208f4f6c7d68e6a10b49b9d0b7bdacde97774ab1d4c609e04b0dd13a1e1f7}{QAESEncryption::AES\_256}}, 
      \mbox{\hyperlink{class_q_a_e_s_encryption_ad3e031c49a3d56566379d75b40b7b255a4ca7f51778e2adf1f464164a0ba8e75e}{QAESEncryption::ECB}});
00530     QByteArray new\_data = encryption.\mbox{\hyperlink{class_q_a_e_s_encryption_a58f972f2b66c2454edd5112495463bba}{decode}}(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, hashKey);
00531     \textcolor{comment}{// Decompressing}
00532     \textcolor{keywordflow}{return} qUncompress(new\_data);
00533 \}
\Hypertarget{modelpc_8cpp_source_l00542}\mbox{\hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{00542}} QByteArray \mbox{\hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{ModelPC::zip}}(QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, QByteArray \mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}})
00543 \{
00544     \textcolor{comment}{// Zip}
00545     QByteArray c\_data = qCompress(\mbox{\hyperlink{namespace_errors_dict_setup_af570460846fb9f0c91abd308a095dcdc}{data}}, 9);
00546     \textcolor{comment}{// Encryption}
00547     QByteArray hashKey = QCryptographicHash::hash(\mbox{\hyperlink{namespace_errors_dict_setup_a09c268098d09ffb8e5504f30fa6d5dd9}{key}}, QCryptographicHash::Sha256);
00548     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_q_a_e_s_encryption_a43819eeb6a7cb29fbd3cb6ad640dcbdf}{QAESEncryption::Crypt}}(\mbox{\hyperlink{class_q_a_e_s_encryption_abe48208f4f6c7d68e6a10b49b9d0b7bdacde97774ab1d4c609e04b0dd13a1e1f7}{QAESEncryption::AES\_256}}, 
      \mbox{\hyperlink{class_q_a_e_s_encryption_ad3e031c49a3d56566379d75b40b7b255a4ca7f51778e2adf1f464164a0ba8e75e}{QAESEncryption::ECB}}, c\_data, hashKey);
00549 \}
00550 
00551 \textcolor{keywordtype}{bool} ModelPC::fileExists(QString path)
00552 \{
00553     QFileInfo check\_file(path);
00554     \textcolor{keywordflow}{return} check\_file.exists() && check\_file.isFile();
00555 \}
00556 
00563 QByteArray ModelPC::bytes(\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} n)
00564 \{
00565     \textcolor{keywordflow}{return} QByteArray::fromHex(QByteArray::number(n, 16));
00566 \}
00573 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} ModelPC::mod(\textcolor{keywordtype}{int} input)
00574 \{
00575     \textcolor{keywordflow}{if}(input < 0)
00576         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}) (256 + input);
00577     \textcolor{keywordflow}{else}
00578         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}) input;
00579 \}
\Hypertarget{modelpc_8cpp_source_l00586}\mbox{\hyperlink{class_model_p_c_a9079a101d83672aa48fd2dbac797de40}{00586}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_model_p_c_a9079a101d83672aa48fd2dbac797de40}{ModelPC::alert}}(QString message, \textcolor{keywordtype}{bool} isWarning)
00587 \{
00588     emit \mbox{\hyperlink{class_model_p_c_aef1f058227af54e4cfc9fc4c4397d30c}{alertView}}(message, isWarning);
00589 \}
00595 QColor ModelPC::RGBbytes(\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} byte)
00596 \{
00597     \textcolor{keywordtype}{int} blue = byte % 256;
00598     \textcolor{keywordtype}{int} green = (byte / 256) % 256;
00599     \textcolor{keywordtype}{int} red = byte / pow(2, 16);
00600     \textcolor{keywordflow}{return} QColor(red, green, blue);
00601 \}
00602 
00603 QString ModelPC::generateVersionString(\textcolor{keywordtype}{long} ver)
00604 \{
00605     \textcolor{keywordflow}{return} QString::number((\textcolor{keywordtype}{int})( ver / pow(2, 16))) + \textcolor{stringliteral}{"."} + QString::number(((\textcolor{keywordtype}{int}) (ver / 256)) % 256) + \textcolor{stringliteral}{"
      ."} + QString::number(ver % 256);
00606 \}
00607 
00608 uint ModelPC::randSeed()
00609 \{
00610     QTime time = QTime::currentTime();
00611     uint randSeed = time.msecsSinceStartOfDay() % 65536 + time.minute() * 21 + time.second() * 2;
00612     \textcolor{keywordflow}{return} randSeed;
00613 \}
\end{DoxyCode}
