\hypertarget{modelpc_8cpp_source}{\section{modelpc.\-cpp}
}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{modelpc_8h}{modelpc.h}"}
00002 \textcolor{preprocessor}{#include <QDebug>}
00003 \textcolor{preprocessor}{#include <QtMath>}
\hypertarget{modelpc_8cpp_source_l00009}{}\hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{00009} \hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{ModelPC::ModelPC}()
00010 \{
00011     \textcolor{comment}{// Version control}
00012     \hyperlink{class_model_p_c_a5f426725ccf7eefd3c77ea8c720264c9}{versionString} = \textcolor{stringliteral}{"1.3.7"};
00013 
00014     \textcolor{keyword}{auto} ver = \hyperlink{class_model_p_c_a5f426725ccf7eefd3c77ea8c720264c9}{versionString}.split(\textcolor{stringliteral}{"."});
00015     \hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version} = ver[0].toInt() * qPow(2, 16) + ver[1].toInt() * qPow(2, 8) + ver[2].toInt();
00016 
00017     ver\_byte = bytes(ver[0].toInt()) +
00018             bytes(ver[1].toInt()) +
00019             bytes(ver[2].toInt());
00020     \textcolor{comment}{// Random seed}
00021     qsrand(randSeed());
00022 \}
00023 
\hypertarget{modelpc_8cpp_source_l00024}{}\hyperlink{class_model_p_c_a271cf9285e32df58ffbfc918e6482bbd}{00024} QImage *\hyperlink{class_model_p_c_a271cf9285e32df58ffbfc918e6482bbd}{ModelPC::Encrypt}(QByteArray \hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data}, QImage *image, \textcolor{keywordtype}{int} \_mode, QString key, \textcolor{keywordtype}{int} 
      \_bitsUsed, QString *\_error)
00025 \{
00026     \textcolor{keywordflow}{return} \hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{ModelPC}().encrypt(data, image, \_mode, key, \_bitsUsed, \_error);
00027 \}
00028 
\hypertarget{modelpc_8cpp_source_l00029}{}\hyperlink{class_model_p_c_ac17e68e6aab134621b0d151d74acdc82}{00029} QImage *\hyperlink{class_model_p_c_ac17e68e6aab134621b0d151d74acdc82}{ModelPC::Inject}(QByteArray encr\_data, QImage *image, \textcolor{keywordtype}{int} \_mode, \textcolor{keywordtype}{int} \_bitsUsed, 
      QString *\_error)
00030 \{
00031     \textcolor{keywordflow}{return} \hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{ModelPC}().inject(encr\_data, image, \_mode, \_bitsUsed, \_error);
00032 \}
00033 
\hypertarget{modelpc_8cpp_source_l00034}{}\hyperlink{class_model_p_c_a902abaea4f07995b48c0f2fea6eceb7c}{00034} QByteArray \hyperlink{class_model_p_c_a902abaea4f07995b48c0f2fea6eceb7c}{ModelPC::Decrypt}(QImage *image, QString key, \textcolor{keywordtype}{int} \_mode, QString *\_error)
00035 \{
00036     \textcolor{keywordflow}{return} \hyperlink{class_model_p_c_ae12ebe65ec973c02a0de4850a7c1e31c}{ModelPC}().decrypt(image, key, \_mode, \_error);
00037 \}
\hypertarget{modelpc_8cpp_source_l00051}{}\hyperlink{class_model_p_c_a6f191f62d4635d0d3555fcc0be298794}{00051} QImage * \hyperlink{class_model_p_c_a6f191f62d4635d0d3555fcc0be298794}{ModelPC::encrypt}(QByteArray \hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data}, QImage * image, \textcolor{keywordtype}{int} \_mode, QString key, \textcolor{keywordtype}{int} 
      \_bitsUsed, QString *\_error)
00052 \{
00053     \textcolor{comment}{// FIXME check for errors}
00054     \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceb}{CryptMode} mode = \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceb}{CryptMode}(\_mode);
00055     \textcolor{comment}{// Error management}
00056     \textcolor{keywordflow}{if}(\_error == \textcolor{keyword}{nullptr})
00057         \_error = \textcolor{keyword}{new} QString();
00058     *\_error = \textcolor{stringliteral}{"ok"};
00059     \hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error} = \_error;
00060 
00061     \textcolor{keywordflow}{if}(data.isEmpty()) \{
00062         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"nodata"});
00063         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00064     \}
00065     \textcolor{keywordflow}{if}(image == \textcolor{keyword}{nullptr} || image->isNull()) \{
00066         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"nullimage"});
00067         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00068     \}
00069     \textcolor{keywordflow}{if}(\_bitsUsed < 1 || \_bitsUsed > 8) \{
00070         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"bitsWrong"});
00071         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00072     \}
00073     \textcolor{keywordflow}{if}(key.isEmpty()) \{
00074         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"no\_key"});
00075         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00076     \}
00077     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(key.size() > 255) \{
00078         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"bigkey"});
00079         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00080     \}
00081     \textcolor{keywordflow}{if}(mode == CryptMode::NotDefined) \{
00082         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"undefined\_mode"});
00083         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00084     \}
00085     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} usedBytes = data.size() + 14 + key.size();
00086     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} size = image->width() * image->height();
00087     \textcolor{keywordflow}{if}(usedBytes * 100 / (size * 3) * 8 / \_bitsUsed > 70) \{
00088         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"muchdata"});
00089         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00090     \}
00091 
00092     \textcolor{keywordflow}{switch}(mode)
00093     \{
00094         \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba7612e38de7178170655a56ddcf96e12c}{v1\_3}:
00095         \{
00096             QByteArray zipped\_data = \hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{zip}(data, key.toUtf8());
00097             QByteArray hash = QCryptographicHash::hash(data, QCryptographicHash::Sha256);
00098             QByteArray encr\_data = hash + zipped\_data;
00099             \textcolor{keywordflow}{if}(*\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error} == \textcolor{stringliteral}{"ok"})
00100                 \textcolor{keywordflow}{return} \hyperlink{class_model_p_c_aada6a04d81ada8f2b4ba18108c8d6f10}{inject}(encr\_data, image, \_mode, \_bitsUsed, \hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error});
00101             \textcolor{keywordflow}{else}
00102                 \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00103             \textcolor{keywordflow}{break};
00104         \}
00105         \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba43138df6b33a6b2bf608768907f95abc}{v1\_4}:
00106             bitsUsed = \_bitsUsed;
00107             \hyperlink{class_model_p_c_a4daefc3fb87a1f19172b9b20c987eb12}{encryptv1\_4}(image, data, key);
00108             \textcolor{keywordflow}{return} image;
00109         \textcolor{keywordflow}{break};
00110         \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba90ca32d3ccbb6be224cdfc33f7096eea}{jphs\_mode}:
00111             \textcolor{comment}{// TODO add jphs}
00112             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00113         \textcolor{keywordflow}{break};
00114         \textcolor{keywordflow}{default}:
00115             \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"wrongmode"});
00116             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00117     \}
00118 \}
00119 
\hypertarget{modelpc_8cpp_source_l00130}{}\hyperlink{class_model_p_c_aada6a04d81ada8f2b4ba18108c8d6f10}{00130} QImage * \hyperlink{class_model_p_c_aada6a04d81ada8f2b4ba18108c8d6f10}{ModelPC::inject}(QByteArray encr\_data, QImage * image, \textcolor{keywordtype}{int} \_mode, \textcolor{keywordtype}{int} \_bitsUsed, 
      QString *\_error)
00131 \{
00132     \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceb}{CryptMode} mode = \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceb}{CryptMode}(\_mode);
00133     \textcolor{comment}{// Error management}
00134     \textcolor{keywordflow}{if}(\_error == \textcolor{keyword}{nullptr})
00135         \_error = \textcolor{keyword}{new} QString();
00136     *\_error = \textcolor{stringliteral}{"ok"};
00137     \hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error} = \_error;
00138 
00139     bitsUsed = \_bitsUsed;
00140 
00141     \textcolor{keywordflow}{if}(encr\_data.isEmpty()) \{
00142         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"nodata"});
00143         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00144     \}
00145     \textcolor{keywordflow}{if}(image == \textcolor{keyword}{nullptr} || image->isNull()) \{
00146         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"nullimage"});
00147         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00148     \}
00149     \textcolor{keywordflow}{if}(\_bitsUsed < 1 || \_bitsUsed > 8) \{
00150         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"bitsWrong"});
00151         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00152     \}
00153     \textcolor{keywordflow}{if}(mode == CryptMode::NotDefined) \{
00154         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"undefined\_mode"});
00155         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00156     \}
00157 
00158     encr\_data = ver\_byte + encr\_data;
00159     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} countBytes = encr\_data.size();
00160     \textcolor{keywordflow}{switch}(mode)
00161     \{
00162     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba7612e38de7178170655a56ddcf96e12c}{v1\_3}:
00163         \hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{circuit}(image, &encr\_data, countBytes);
00164         \textcolor{keywordflow}{break};
00165     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba90ca32d3ccbb6be224cdfc33f7096eea}{jphs\_mode}:
00166         \hyperlink{class_model_p_c_a8bee0255c09449868c7e6097afaaf0cd}{jphs}(image, &encr\_data);
00167         \textcolor{keywordflow}{break};
00168     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba43138df6b33a6b2bf608768907f95abc}{v1\_4}:
00169         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"inject-v1.4"});
00170         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00171         \textcolor{keywordflow}{break};
00172     \textcolor{keywordflow}{default}:
00173         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"wrongmode"});
00174         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00175     \}
00176 
00177 
00178     \textcolor{comment}{// Saving}
00179     \textcolor{keywordflow}{if}(\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success}) \{
00180         emit \hyperlink{class_model_p_c_a41f5e2e8022679046e4d3fa1109025fa}{saveImage}(image);
00181         \textcolor{keywordflow}{return} image;
00182     \}
00183     \textcolor{keywordflow}{else}
00184         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00185 \}
\hypertarget{modelpc_8cpp_source_l00195}{}\hyperlink{class_model_p_c_a5995215a34a1e1f504035715a8013809}{00195} QByteArray \hyperlink{class_model_p_c_a5995215a34a1e1f504035715a8013809}{ModelPC::decrypt}(QImage * image, QString key, \textcolor{keywordtype}{int} \_mode, QString *\_error)
00196 \{
00197     \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceb}{CryptMode} mode = \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceb}{CryptMode}(\_mode);
00198     \textcolor{comment}{// Error management}
00199     \textcolor{keywordflow}{if}(\_error == \textcolor{keyword}{nullptr})
00200         \_error = \textcolor{keyword}{new} QString();
00201     *\_error = \textcolor{stringliteral}{"ok"};
00202     \hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error} = \_error;
00203     \textcolor{keywordflow}{if}(image == \textcolor{keyword}{nullptr} || image->isNull()) \{
00204         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"nullimage"});
00205         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00206     \}
00207     QByteArray result;
00208 
00209     \textcolor{keywordflow}{switch} (mode) \{
00210     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba7612e38de7178170655a56ddcf96e12c}{v1\_3}:
00211         result = \hyperlink{class_model_p_c_a4fe70ebbedfaf31d45a35f82d0f06caa}{decryptv1\_3}(image, key);
00212     \textcolor{keywordflow}{break};
00213     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba43138df6b33a6b2bf608768907f95abc}{v1\_4}:
00214         result = \hyperlink{class_model_p_c_a7a1f7d491e1bde16936190b9e90896b0}{decryptv1\_4}(image, key);
00215     \textcolor{keywordflow}{break};
00216     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba90ca32d3ccbb6be224cdfc33f7096eea}{jphs\_mode}:
00217         \textcolor{comment}{// TODO add jphs support}
00218     \textcolor{keywordflow}{break};
00219     \textcolor{keywordflow}{case} \hyperlink{class_model_p_c_a296dd7afe3e1c49b3da25fd644fe4ceba287198790ac9799acd03c99d63a6faea}{NotDefined}:
00220         \textcolor{comment}{// TODO check all upper functions}
00221     \textcolor{keywordflow}{break};
00222     \textcolor{keywordflow}{default}:
00223         \textcolor{comment}{// For invalid modes}
00224         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"wrongmode"});
00225         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00226     \}
00227     \textcolor{keywordflow}{if}(*\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error} == \textcolor{stringliteral}{"ok"})
00228         emit \hyperlink{class_model_p_c_a0855107fb0ccc247cd9e893fae9bb08a}{saveData}(result);
00229     \textcolor{keywordflow}{return} result;
00230 \}
\hypertarget{modelpc_8cpp_source_l00235}{}\hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{00235} \textcolor{keywordtype}{void} \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{ModelPC::fail}(QString message)
00236 \{
00237     *\hyperlink{class_model_p_c_a4e5a9c0ca1f06fe5bc478b6bf248c37c}{error} = message;
00238     \hyperlink{class_model_p_c_a9079a101d83672aa48fd2dbac797de40}{alert}(message, \textcolor{keyword}{true});
00239     \hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success} = \textcolor{keyword}{false};
00240     emit \hyperlink{class_model_p_c_afdcd80f0ed5062e145a71f09b0897547}{setProgress}(101);
00241 \}
\hypertarget{modelpc_8cpp_source_l00247}{}\hyperlink{class_model_p_c_a8bee0255c09449868c7e6097afaaf0cd}{00247} \textcolor{keywordtype}{void} \hyperlink{class_model_p_c_a8bee0255c09449868c7e6097afaaf0cd}{ModelPC::jphs}(QImage *image, QByteArray *\hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data})
00248 \{
00249     \textcolor{comment}{// Under Development}
00250     \textcolor{keywordflow}{return};
00251 
00252     \textcolor{comment}{// Dead code}
00253 
00254     \hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success} = \textcolor{keyword}{true};
00255     \textcolor{keywordtype}{bool} isEncrypt = !data->isEmpty();
00256     QString targetEXE = \hyperlink{class_model_p_c_abd038306f14f22fb885a1697c96d6335}{defaultJPHSDir} + (isEncrypt ? \textcolor{stringliteral}{"/jphide.exe"} : \textcolor{stringliteral}{"/jpseek.exe"});
00257     \textcolor{keywordflow}{if}(!fileExists(targetEXE))
00258     \{
00259         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"nojphs"});
00260         \textcolor{keywordflow}{return};
00261     \}
00262 
00263     QString randomFileName = \hyperlink{class_model_p_c_abd038306f14f22fb885a1697c96d6335}{defaultJPHSDir} + \textcolor{stringliteral}{"/"};
00264     qsrand(randSeed());
00265     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 10; i++)
00266         randomFileName.append(97 + qrand() % 25);
00267     image->save(randomFileName + \textcolor{stringliteral}{".jpg"});
00268     \textcolor{keywordflow}{if}(isEncrypt) \{
00269         QFile file(randomFileName + \textcolor{stringliteral}{".pc"});
00270         \textcolor{keywordflow}{if}(!file.open(QFile::WriteOnly)) \{
00271             \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"savefilefail"});
00272             \textcolor{keywordflow}{return};
00273         \}
00274         file.write(*data);
00275         file.close();
00276 
00277         QStringList args;
00278         args << (randomFileName + \textcolor{stringliteral}{".jpg"}) << (randomFileName + \textcolor{stringliteral}{"\_out.jpg"}) << (randomFileName + \textcolor{stringliteral}{".pc"});
00279         QProcess prog(\textcolor{keyword}{this});
00280         prog.start(targetEXE, args);
00281         prog.waitForStarted();
00282         prog.write(\textcolor{stringliteral}{"test\(\backslash\)n"});
00283         prog.waitForBytesWritten();
00284         prog.write(\textcolor{stringliteral}{"test\(\backslash\)n"});
00285         prog.waitForBytesWritten();
00286         prog.waitForReadyRead();
00287         QByteArray bytes = prog.readAll();
00288         prog.waitForFinished();
00289         \textcolor{comment}{//QByteArray readData = prog.readAll();}
00290         prog.close();
00291         \textcolor{comment}{// Cleaning - Deleting temp files}
00292 
00293     \}
00294     \textcolor{keywordflow}{else} \{
00295 
00296     \}
00297 
00298 \}
00299 
\hypertarget{modelpc_8cpp_source_l00308}{}\hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{00308} \textcolor{keywordtype}{void} \hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{ModelPC::circuit}(QImage *image, QByteArray *\hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data}, \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} countBytes)
00309 \{
00310     \textcolor{comment}{// Some flags and creation of the ProgressDialog}
00311     \hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success} = \textcolor{keyword}{true};
00312     emit \hyperlink{class_model_p_c_afdcd80f0ed5062e145a71f09b0897547}{setProgress}(-1);
00313     \textcolor{keywordtype}{bool} isEncrypt = !data->isEmpty();
00314 
00315     \textcolor{comment}{// Image setup}
00316     \textcolor{keywordtype}{int} w = image->width();
00317     \textcolor{keywordtype}{int} h = image->height();
00318 
00319     \textcolor{comment}{// Visited pixels array}
00320     QVector <QPoint> were;
00321     were.push\_back(QPoint(0, 0));
00322     were.push\_back(QPoint(0, h - 1));
00323     were.push\_back(QPoint(w - 1, 0));
00324     were.push\_back(QPoint(w - 1, h - 1));
00325 
00326     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} offset = 0;
00327 
00328     \textcolor{comment}{// Pre-start Cleaning}
00329     circuitData = \hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data};
00330     circuitImage = image;
00331     circuitCountBytes = countBytes;
00332     cur = 0;
00333     bitsBuffer.clear();
00334 
00335     \textcolor{comment}{// Writing Top-Left to Bottom-Left}
00336     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 1; i < h - 1 && mustGoOn(isEncrypt); i++) \{
00337         QPoint pos(0, i);
00338         \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}(pos, &were, isEncrypt);
00339     \}
00340     \textcolor{comment}{// Writing Bottom-Right to Top-Right}
00341     \textcolor{keywordflow}{if}(mustGoOn(isEncrypt))
00342     \{
00343         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = h - 2; i >= 1 && mustGoOn(isEncrypt); i--)\{
00344             QPoint pos(w - 1, i);
00345             \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}(pos, &were, isEncrypt);
00346         \}
00347     \}
00348     \textcolor{comment}{// Main cycle}
00349     \textcolor{comment}{// Strong is considered as actual corner pixel and weak as pixel near it like (1, 0) or (0, 1)}
00350     \textcolor{keywordflow}{while}(mustGoOn(isEncrypt))
00351     \{
00352         \textcolor{comment}{// Strong Top-Right to Strong Bottom-Right}
00353         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = offset; i < h - offset && mustGoOn(isEncrypt); i++)\{
00354             QPoint pos(w - offset - 2, i);
00355             \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}(pos, &were, isEncrypt);
00356         \}
00357         \textcolor{comment}{// Strong Top-Left to Weak Top-Right}
00358         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = offset + 1; i < w - offset - 2 && mustGoOn(isEncrypt); i++)\{
00359             QPoint pos(i, offset);
00360             \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}(pos, &were, isEncrypt);
00361         \}
00362         \textcolor{comment}{// Weak Bottom-Right to Weak Bottom-Left}
00363         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = w - 3 - offset; i >= offset + 2 && mustGoOn(isEncrypt); i--)\{
00364             QPoint pos(i, h - offset - 1);
00365             \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}(pos, &were, isEncrypt);
00366         \}
00367         \textcolor{comment}{// Weak Top-Left to Strong Bottom-Left}
00368         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = offset + 1; i < h - offset && mustGoOn(isEncrypt); i++)\{
00369             QPoint pos(offset + 1, i);
00370             \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{processPixel}(pos, &were, isEncrypt);
00371         \}
00372         offset++;
00373     \}
00374     \textcolor{comment}{// Extra writing}
00375     \textcolor{keywordflow}{if}(!\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success})
00376         \textcolor{keywordflow}{return};
00377     \textcolor{keywordflow}{if}(isEncrypt)
00378     \{
00379         \textcolor{comment}{// Getting past colors}
00380         QColor colUL = image->pixelColor(0, 0).toRgb();
00381         QColor colUR = image->pixelColor(w - 1, 0).toRgb();
00382         QColor colDL = image->pixelColor(0, h - 1).toRgb();
00383         QColor colDR = image->pixelColor(w - 1, h - 1).toRgb();
00384         \textcolor{keywordtype}{int} red = 0;
00385         \textcolor{keywordtype}{int} green = 0;
00386         \textcolor{keywordtype}{int} blue = 0;
00387 
00388         \textcolor{comment}{// Writing Upper Left}
00389         red = (colUL.red() & 224) + (countBytes >> 19);
00390         green = (colUL.green() & 224) + (countBytes >> 14) % 32;
00391         blue = (colUL.blue() & 224) + (countBytes >> 9) % 32;
00392         image->setPixelColor(0, 0, QColor(red, green, blue));
00393 
00394         \textcolor{comment}{// Writing Upper Right}
00395         red = (colUR.red() & 224) + (countBytes >> 4) % 32;
00396         green = (colUR.green() & 224) + ((countBytes % 16) << 1) + 1;
00397         blue = (colUR.blue() & 224) + 9;
00398         image->setPixelColor(w - 1, 0, QColor(red, green, blue));
00399 
00400         \textcolor{comment}{// Getting extra bytes if left}
00401         \textcolor{keywordflow}{while}(cur < countBytes)
00402             push(mod(circuitData->at(cur++)), 8);
00403         \textcolor{keywordflow}{if}(bitsBuffer.size() > 20) \{
00404             \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"bitsBufferFail"});
00405             \textcolor{keywordflow}{return};
00406         \}
00407         \textcolor{comment}{// Getting extra data as long.}
00408         \textcolor{keywordtype}{long} extraData = pop(-2);
00409 
00410         \textcolor{comment}{// Writing Down Left}
00411         red = (colDL.red() & 224) + (extraData >> 15);
00412         green = (colDL.green() & 224) + (extraData >> 10) % 32;
00413         blue = (colDL.blue() & 224) + (extraData >> 5) % 32;
00414         image->setPixelColor(0, h - 1, QColor(red, green, blue));
00415 
00416         \textcolor{comment}{// Writing Down Right}
00417         red = (colDR.red() & 224) + extraData % 32;
00418         green = (colDR.green() & 224);
00419         blue = (colDR.blue() & 224) + ((bitsUsed - 1) << 2) + 2;
00420         image->setPixelColor(w - 1, h - 1, QColor(red, green, blue));
00421     \}
00422     \textcolor{keywordflow}{else}
00423     \{
00424         \textcolor{comment}{// Read the past pixels}
00425         QColor colDL = image->pixelColor(0, h - 1).toRgb();
00426         QColor colDR = image->pixelColor(w - 1, h - 1).toRgb();
00427 
00428         \textcolor{comment}{// Read extra data}
00429         \textcolor{keywordtype}{long} extraData = ((colDL.red() % 32) << 15) + ((colDL.green() % 32) << 10);
00430         extraData += ((colDL.blue() % 32) << 5) + colDR.red() % 32;
00431 
00432         \textcolor{comment}{// Add extra data to the bitsBuffer}
00433         push(extraData, (countBytes - cur) * 8 - bitsBuffer.size());
00434 
00435         \textcolor{comment}{// Move bits from bitsBuffer to the QByteArray}
00436         \textcolor{keywordflow}{while}(!bitsBuffer.isEmpty())
00437             data->append(pop(8));
00438     \}
00439     emit \hyperlink{class_model_p_c_afdcd80f0ed5062e145a71f09b0897547}{setProgress}(101);
00440 \}
00441 
\hypertarget{modelpc_8cpp_source_l00449}{}\hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{00449} \textcolor{keywordtype}{void} \hyperlink{class_model_p_c_a1171f9fe1550133dc9053a46b4e5bcfd}{ModelPC::processPixel}(QPoint pos, QVector<QPoint> *were, \textcolor{keywordtype}{bool} isEncrypt)
00450 \{
00451     \textcolor{keywordflow}{if}(!\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success})
00452         \textcolor{keywordflow}{return};
00453     \textcolor{comment}{// Check if point was already visited}
00454     \textcolor{keywordflow}{if}(were->contains(pos))\{
00455         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"Point ("} + QString::number(pos.x()) + \textcolor{stringliteral}{","} + QString::number(pos.y()) + \textcolor{stringliteral}{") was visited
       twice! Error code 2"});
00456         \textcolor{keywordflow}{return};
00457     \}
00458     \textcolor{keywordflow}{else}
00459         were->push\_back(pos);
00460     \textcolor{keywordflow}{if}(isEncrypt)
00461     \{
00462         \textcolor{comment}{// Make sure that there are enough bits in bitsBuffer to write}
00463         \textcolor{keywordflow}{while}(bitsBuffer.size() < 3 * bitsUsed)
00464             push(mod(circuitData->at(cur++)), 8);
00465         \textcolor{comment}{// Read past contains}
00466         QColor pixelColor = circuitImage->pixelColor(pos);
00467         \textcolor{keywordtype}{int} red = pixelColor.red();
00468         \textcolor{keywordtype}{int} green = pixelColor.green();
00469         \textcolor{keywordtype}{int} blue = pixelColor.blue();
00470 
00471         \textcolor{comment}{// Write new data in last bitsUsed pixels}
00472         red += pop() - red % (int) qPow(2, bitsUsed);
00473         green += pop() - green % (int) qPow(2, bitsUsed);
00474         blue += pop() - blue % (int) qPow(2, bitsUsed);
00475 
00476         circuitImage->setPixelColor(pos, QColor(red, green, blue));
00477     \}
00478     \textcolor{keywordflow}{else}
00479     \{
00480         QColor read\_color = circuitImage->pixelColor(pos).toRgb();
00481         \textcolor{comment}{// Reading the pixel}
00482         \textcolor{keywordtype}{int} red = read\_color.red();
00483         \textcolor{keywordtype}{int} green = read\_color.green();
00484         \textcolor{keywordtype}{int} blue = read\_color.blue();
00485 
00486         \textcolor{comment}{// Reading the last bitsUsed pixels}
00487         red %= (int) qPow(2, bitsUsed);
00488         green %= (int) qPow(2, bitsUsed);
00489         blue %= (int) qPow(2, bitsUsed);
00490 
00491         \textcolor{comment}{// Getting the data in the bitsBuffer.}
00492         push(red);
00493         push(green);
00494         push(blue);
00495 
00496         \textcolor{comment}{// Getting data to QByteArray}
00497         \textcolor{keywordflow}{while}(bitsBuffer.size() >= 8) \{
00498             circuitData->append(pop(8));
00499             cur++;
00500         \}
00501     \}
00502     emit \hyperlink{class_model_p_c_afdcd80f0ed5062e145a71f09b0897547}{setProgress}(100 * cur / circuitCountBytes);
00503 \}
\hypertarget{modelpc_8cpp_source_l00509}{}\hyperlink{class_model_p_c_a4daefc3fb87a1f19172b9b20c987eb12}{00509} \textcolor{keywordtype}{void} \hyperlink{class_model_p_c_a4daefc3fb87a1f19172b9b20c987eb12}{ModelPC::encryptv1\_4}(QImage *image, QByteArray \hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data}, QString key)
00510 \{
00511     QByteArray rand\_master = GetRandomBytes(32);
00512     QByteArray pass = QCryptographicHash::hash(key.toUtf8() + rand\_master + QString(\textcolor{stringliteral}{"hi"}).toUtf8(), 
      QCryptographicHash::Sha3\_384);
00513     QByteArray noise = GetRandomBytes(data.size() / 10 + 32);
00514     QByteArray bytes\_key = GetRandomBytes(32);
00515     QByteArray pass\_rand = QCryptographicHash::hash(pass + bytes\_key, QCryptographicHash::Sha3\_256);
00516     QByteArray zipped = \hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{zip}(data, pass\_rand);
00517 \}
\hypertarget{modelpc_8cpp_source_l00524}{}\hyperlink{class_model_p_c_a7a1f7d491e1bde16936190b9e90896b0}{00524} QByteArray \hyperlink{class_model_p_c_a7a1f7d491e1bde16936190b9e90896b0}{ModelPC::decryptv1\_4}(QImage *image, QString key)
00525 \{
00526 
00527 \}
00528 
\hypertarget{modelpc_8cpp_source_l00535}{}\hyperlink{class_model_p_c_a4fe70ebbedfaf31d45a35f82d0f06caa}{00535} QByteArray \hyperlink{class_model_p_c_a4fe70ebbedfaf31d45a35f82d0f06caa}{ModelPC::decryptv1\_3}(QImage *image, QString key)
00536 \{
00537     \textcolor{comment}{// Image opening}
00538     \textcolor{keywordtype}{int} w = image->width();
00539     \textcolor{keywordtype}{int} h = image->height();
00540 
00541     \textcolor{comment}{// Getting corner pixels}
00542     QColor colUL = image->pixelColor(0, 0).toRgb();
00543     QColor colUR = image->pixelColor(w - 1, 0).toRgb();
00544     QColor colDR = image->pixelColor(w - 1, h - 1).toRgb();
00545 
00546 
00547     \textcolor{comment}{// Getting verification code}
00548     \textcolor{keywordtype}{int} verifCode = (((colUR.green() % 2) << 5) + colUR.blue() % 32) << 2;
00549     verifCode += colDR.blue() % 4;
00550     \textcolor{keywordflow}{if}(verifCode != 166)\{
00551         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"veriffail"});
00552         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00553     \}
00554     \textcolor{comment}{// Getting number of bytes}
00555     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} countBytes = (colUL.blue() % 32 + ((colUL.green() % 32) << 5) + ((colUL.red() % 32) << 10
      )) << 9;
00556     countBytes += ((colUR.red() % 32) << 4) + (colUR.green() >> 1) % 16;
00557 
00558     bitsUsed = (colDR.blue() >> 2) % 8 + 1;
00559     \textcolor{comment}{// FIXME check if works}
00560     \textcolor{comment}{// curMode = colDR.green() % 32;}
00561 
00562     \textcolor{comment}{// Start of the circuit}
00563     QByteArray \hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data};
00564     \hyperlink{class_model_p_c_a1d0091062a0c836b283ec2f67411623b}{circuit}(image, &data, countBytes);
00565 
00566     \textcolor{comment}{// Check if circuit was successful}
00567     \textcolor{keywordflow}{if}(!\hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success})
00568         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00569     \textcolor{keywordflow}{if}(data.isEmpty())
00570     \{
00571         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"noreaddata"});
00572         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00573 
00574     \}
00575     \textcolor{comment}{// Version check}
00576     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} \_ver = mod(data.at(0)) * qPow(2, 16);
00577     \_ver += mod(data.at(1)) * qPow(2, 8);
00578     \_ver += mod(data.at(2));
00579     data.remove(0, 3);
00580     \textcolor{keywordflow}{if}(\_ver > \hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}) \{
00581         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"Picture's app version is newer than yours. Image version is "}
00582               + generateVersionString(\_ver) + \textcolor{stringliteral}{", yours is "}
00583               + generateVersionString(\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}) + \textcolor{stringliteral}{"."});
00584         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00585     \}
00586     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\_ver < \hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}) \{
00587         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"Picture's app version is older than yours. Image version is "}
00588               + generateVersionString(\_ver) + \textcolor{stringliteral}{", yours is "}
00589               + generateVersionString(\hyperlink{class_model_p_c_a5af48ab89e19be42a94c34ba00249401}{version}) + \textcolor{stringliteral}{"."});
00590         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
00591     \}
00592     \textcolor{comment}{// Get the hash}
00593     QByteArray hash = data.left(32);
00594     data.remove(0, 32);
00595 
00596     \textcolor{comment}{// Unzip}
00597     QByteArray unzipped\_data = \hyperlink{class_model_p_c_a6da88f166785a49f73b22c169f956fd0}{unzip}(data, key.toUtf8());
00598     QByteArray our\_hash = QCryptographicHash::hash(unzipped\_data, QCryptographicHash::Sha256);
00599     \textcolor{keywordflow}{if}(our\_hash != hash) \{
00600         \hyperlink{class_model_p_c_a47464b59b7e37fcee25e55475708aabd}{fail}(\textcolor{stringliteral}{"fail\_hash"});
00601         \textcolor{keywordflow}{return} QByteArray(\textcolor{stringliteral}{""});
00602     \}
00603     \textcolor{keywordflow}{return} unzipped\_data;
00604 \}
00605 \textcolor{keywordtype}{long} ModelPC::pop(\textcolor{keywordtype}{int} bits)
00606 \{
00607     \textcolor{comment}{// Hard to say}
00608     \textcolor{keywordtype}{long} res = 0;
00609     \textcolor{keywordtype}{int} poppedBits = bits == -1 ? bitsUsed : bits;
00610     \textcolor{keywordflow}{if}(bits == -2)
00611         poppedBits = bitsBuffer.size();
00612     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < poppedBits; i++)
00613         res += bitsBuffer[i] * qPow(2, poppedBits - i - 1);
00614     bitsBuffer.remove(0, poppedBits);
00615     \textcolor{keywordflow}{return} res;
00616 \}
00617 
00618 \textcolor{keywordtype}{void} ModelPC::push(\textcolor{keywordtype}{int} \hyperlink{namespace_errors_dict_setup_adf4c30d205d29df7343e26f7c62b0685}{data}, \textcolor{keywordtype}{int} bits)
00619 \{
00620     \textcolor{comment}{// That's easier, but also hard}
00621     \textcolor{keywordtype}{int} buf\_size = bitsBuffer.size();
00622     \textcolor{keywordtype}{int} extraSize = bits == -1 ? bitsUsed : bits;
00623     bitsBuffer.resize(buf\_size + extraSize);
00624     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = bitsBuffer.size() - 1; i >= buf\_size; i--, data >>= 1)
00625         bitsBuffer[i] = data % 2;
00626 \}
00627 
00628 \textcolor{keywordtype}{bool} ModelPC::mustGoOn(\textcolor{keywordtype}{bool} isEncrypt)
00629 \{
00630     \textcolor{keywordflow}{return} \hyperlink{class_model_p_c_a945ffbbc44a832b953c191debd448f4c}{success} && (isEncrypt ? (circuitCountBytes - cur) * 8 + bitsBuffer.size() >= bitsUsed * 3
       :
00631                                    circuitData->size() * 8 + bitsBuffer.size() <
00632                                    circuitCountBytes * 8 - (circuitCountBytes * 8)% (bitsUsed * 3));
00633 \}
\hypertarget{modelpc_8cpp_source_l00642}{}\hyperlink{class_model_p_c_a6da88f166785a49f73b22c169f956fd0}{00642} QByteArray \hyperlink{class_model_p_c_a6da88f166785a49f73b22c169f956fd0}{ModelPC::unzip}(QByteArray data, QByteArray key)
00643 \{
00644     \textcolor{comment}{// Decryption}
00645     QByteArray hashKey = QCryptographicHash::hash(key, QCryptographicHash::Sha256);
00646     \hyperlink{class_q_a_e_s_encryption}{QAESEncryption} encryption(\hyperlink{class_q_a_e_s_encryption_abe48208f4f6c7d68e6a10b49b9d0b7bdacde97774ab1d4c609e04b0dd13a1e1f7}{QAESEncryption::AES\_256}, 
      \hyperlink{class_q_a_e_s_encryption_ad3e031c49a3d56566379d75b40b7b255a4ca7f51778e2adf1f464164a0ba8e75e}{QAESEncryption::ECB});
00647     QByteArray new\_data = encryption.\hyperlink{class_q_a_e_s_encryption_a58f972f2b66c2454edd5112495463bba}{decode}(data, hashKey);
00648     \textcolor{comment}{// Decompressing}
00649     \textcolor{keywordflow}{return} qUncompress(new\_data);
00650 \}
\hypertarget{modelpc_8cpp_source_l00659}{}\hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{00659} QByteArray \hyperlink{class_model_p_c_afebbbfa4b07deba4f68fc6dfb50f353f}{ModelPC::zip}(QByteArray data, QByteArray key)
00660 \{
00661     \textcolor{comment}{// Zip}
00662     QByteArray c\_data = qCompress(data, 9);
00663     \textcolor{comment}{// Encryption}
00664     QByteArray hashKey = QCryptographicHash::hash(key, QCryptographicHash::Sha256);
00665     \textcolor{keywordflow}{return} \hyperlink{class_q_a_e_s_encryption_a43819eeb6a7cb29fbd3cb6ad640dcbdf}{QAESEncryption::Crypt}(\hyperlink{class_q_a_e_s_encryption_abe48208f4f6c7d68e6a10b49b9d0b7bdacde97774ab1d4c609e04b0dd13a1e1f7}{QAESEncryption::AES\_256}, 
      \hyperlink{class_q_a_e_s_encryption_ad3e031c49a3d56566379d75b40b7b255a4ca7f51778e2adf1f464164a0ba8e75e}{QAESEncryption::ECB}, c\_data, hashKey);
00666 \}
00667 
00668 \textcolor{keywordtype}{bool} ModelPC::fileExists(QString path)
00669 \{
00670     QFileInfo check\_file(path);
00671     \textcolor{keywordflow}{return} check\_file.exists() && check\_file.isFile();
00672 \}
00673 
00680 QByteArray ModelPC::bytes(\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} n)
00681 \{
00682     \textcolor{keywordflow}{return} QByteArray::fromHex(QByteArray::number(n, 16));
00683 \}
00690 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} ModelPC::mod(\textcolor{keywordtype}{int} input)
00691 \{
00692     \textcolor{keywordflow}{if}(input < 0)
00693         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}) (256 + input);
00694     \textcolor{keywordflow}{else}
00695         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}) input;
00696 \}
\hypertarget{modelpc_8cpp_source_l00703}{}\hyperlink{class_model_p_c_a9079a101d83672aa48fd2dbac797de40}{00703} \textcolor{keywordtype}{void} \hyperlink{class_model_p_c_a9079a101d83672aa48fd2dbac797de40}{ModelPC::alert}(QString message, \textcolor{keywordtype}{bool} isWarning)
00704 \{
00705     emit \hyperlink{class_model_p_c_af0217a7ca5671e26090dc50a5dccdaf5}{alertView}(message, isWarning);
00706 \}
00712 QColor ModelPC::RGBbytes(\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} byte)
00713 \{
00714     \textcolor{keywordtype}{int} blue = byte % 256;
00715     \textcolor{keywordtype}{int} green = (byte / 256) % 256;
00716     \textcolor{keywordtype}{int} red = byte / qPow(2, 16);
00717     \textcolor{keywordflow}{return} QColor(red, green, blue);
00718 \}
00719 
00720 QString ModelPC::generateVersionString(\textcolor{keywordtype}{long} ver)
00721 \{
00722     \textcolor{keywordflow}{return} QString::number((\textcolor{keywordtype}{int})( ver / qPow(2, 16))) + \textcolor{stringliteral}{"."} + QString::number(((\textcolor{keywordtype}{int}) (ver / 256)) % 256) + \textcolor{stringliteral}{
      "."} + QString::number(ver % 256);
00723 \}
00724 
00725 uint ModelPC::randSeed()
00726 \{
00727     QTime time = QTime::currentTime();
00728     uint randSeed = time.msecsSinceStartOfDay() % 65536 + time.minute() * 21 + time.second() * 2;
00729     \textcolor{keywordflow}{return} randSeed;
00730 \}
00731 QByteArray ModelPC::GetRandomBytes(\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} count)
00732 \{
00733     QByteArray res;
00734     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < count; i++)
00735        res += qrand() % 256;
00736     \textcolor{keywordflow}{return} res;
00737 \}
\end{DoxyCode}
